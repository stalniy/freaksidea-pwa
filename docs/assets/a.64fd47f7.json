{"title":"Magento конфигурация от А до Я: system.xml","summary":"В Magento существует очень много настроек. Все они находятся в System ->\nConfiguration. Любой модуль может добавить туда специфические параметры. Новые\nполя, группы и табы - все это делается при помощи конфигурационного файла\nsystem.xml. Рассмотрим его формат\n","author":"sstotskyi","categories":["backend","important"],"createdAt":"2011-12-12T16:47:00.000Z","meta":{"keywords":[]},"alias":"magento-konfiguratsiya-ot-a-do-ya-systemxml","content":"<p>В Magento существует очень много настроек. Все они находятся в <strong>System</strong> -&gt; <strong>Configuration</strong>. Любой модуль может добавить туда специфические параметры. Новые поля, группы и табы - все это делается при помощи конфигурационного файла <em>system.xml</em>.</p>\n<h2 id=\"struktura-fajla\"><a name=\"struktura-fajla\" class=\"h-link\" href=\"#\"></a>Структура файла</h2>\n<p>Все <em>system.xml</em> конфигурационные файлы состоят из нескольких основных частей: табы -&gt; секции -&gt; группы -&gt; поля. В пользовательском интерфейсе это все расположено как-то так</p>\n<p><img src=\"/media/assets/configuration.png\" alt=\"Magento configuration structure\" title=\"Magento configuration structure\" width=\"600\" height=\"324\"></p>\n<p>Все настройки в <em>Magento</em> могут иметь одну из трех областей действия (<em>scope</em>): <strong>default</strong>, <strong>website</strong>, <strong>store</strong>. Настройка заданная в скоупе <em>store</em> переопределяет значения заданные в <em>default</em> и <em>website</em>. Аналогично параметр заданный в скоупе <em>website</em> переопределяет значение по умолчанию, т.е. скоуп <em>default</em>. В начале это может показаться очень сложным, но окажется очень юзабильным, когда у Вас под управлением одной <em>Magento</em> находится несколько сайтов. Область видимости (скоуп) можно переключать при помощи выпадающего списка в верхнем левом углу на странице конфигурации.</p>\n<p>Конфигурационный файл выглядит так</p>\n<pre><code class=\"hljs language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">config</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">tabs</span>&gt;</span>............<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">tabs</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sections</span>&gt;</span>........<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sections</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">config</span>&gt;</span>\n</code></pre>\n<p>Чтобы создать таб достаточно просто задать ему имя и порядок сортировки. Например, открыв <em>Mage_Core</em> модуль можно увидеть</p>\n<pre><code class=\"hljs language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">config</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">tabs</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">general</span> <span class=\"hljs-attr\">translate</span>=<span class=\"hljs-string\">\"label\"</span> <span class=\"hljs-attr\">module</span>=<span class=\"hljs-string\">\"core\"</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">label</span>&gt;</span>General<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">label</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sort_order</span>&gt;</span>100<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sort_order</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">general</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">service</span> <span class=\"hljs-attr\">translate</span>=<span class=\"hljs-string\">\"label\"</span> <span class=\"hljs-attr\">module</span>=<span class=\"hljs-string\">\"core\"</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">label</span>&gt;</span>Services<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">label</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sort_order</span>&gt;</span>99999<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sort_order</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">service</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">advanced</span> <span class=\"hljs-attr\">translate</span>=<span class=\"hljs-string\">\"label\"</span> <span class=\"hljs-attr\">module</span>=<span class=\"hljs-string\">\"core\"</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">label</span>&gt;</span>Advanced<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">label</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sort_order</span>&gt;</span>999999<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sort_order</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">advanced</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">tabs</span>&gt;</span>\n............................................................\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">config</span>&gt;</span>\n</code></pre>\n<p>В этом файле определено 3 таба. При создании таба основным его параметром является код - имя тега. Он понадобится в дальнейшем, чтобы указать секции к какому табу она принадлежит. Например в том же файле</p>\n<pre><code class=\"hljs language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sections</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">advanced</span> <span class=\"hljs-attr\">translate</span>=<span class=\"hljs-string\">\"label\"</span> <span class=\"hljs-attr\">module</span>=<span class=\"hljs-string\">\"core\"</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">label</span>&gt;</span>Advanced<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">label</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">tab</span>&gt;</span>advanced<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">tab</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sort_order</span>&gt;</span>910<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sort_order</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_default</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_default</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_website</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_website</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_store</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_store</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groups</span>&gt;</span>.......<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groups</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">advanced</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sections</span>&gt;</span>\n</code></pre>\n<p>можно определить по тегу <strong>tab</strong>, что секция <strong>Advanced</strong> относится к табу <strong>Advanced</strong>. Секция определяется следующими тегами:</p>\n<ul>\n<li><em>label</em> - название секции</li>\n<li><em>tab</em> - таб к которому она относится (необязательный)</li>\n<li><em>class</em> - задает css класс для ссылки секции, как пример секция <em>PayPal</em>-а (необязательный)</li>\n<li><em>header_css</em> - задает css класс для тега h3, на странице редактирования секции. В качестве примера - тот же <em>PayPal</em> (необязательный)</li>\n<li><em>sort_order</em> - порядковый номер</li>\n<li><em>groups</em> - группы, которые относятся к этой секции</li>\n<li><em>show_in_default</em> - показывать в дефолтном скоупе</li>\n<li><em>show_in_website</em> - показывать в скоупе вебсайта</li>\n<li><em>show_in_store</em> - показывать в скоупе стора</li>\n</ul>\n<p>Атрибут <strong>translate</strong> указывает (через пробел), содержимое каких тегов является мультиязычным. Атрибут <strong>module</strong> указывает, какой модуль ответственный за данную секцию, в основном используется, чтобы создать объект хелпера этого модуля.</p>\n<p>Секция содержит в себе группы, например в <em>advanced</em></p>\n<pre><code class=\"hljs language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">modules_disable_output</span> <span class=\"hljs-attr\">translate</span>=<span class=\"hljs-string\">\"label\"</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">label</span>&gt;</span>Disable Modules Output<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">label</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">frontend_model</span>&gt;</span>adminhtml/system_config_form_fieldset_modules_disableOutput<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">frontend_model</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sort_order</span>&gt;</span>2<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sort_order</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_default</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_default</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_website</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_website</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_store</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_store</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">modules_disable_output</span>&gt;</span>\n</code></pre>\n<p>Эта группа отвечает за отключение вывода блоков определенного модуля. Посмотрим на ее <em>UI</em></p>\n<p><img src=\"/media/assets/disable_module_output.png\" alt=\"Magento disable module output\" title=\"Magento disable module output\" width=\"600\" height=\"311\"></p>\n<p>Обычно в группе задаются поля, но также можно указать <em>frontend_model</em>. Она отвечает за вывод всех полей и должна реализовать интерфейс <em>Varien_Data_Form_Element_Renderer_Interface</em>. В контексте <em>Magento</em> - это на самом деле блок, а не модель.</p>\n<p>Группа задается следующими тегами</p>\n<ul>\n<li><em>label</em> - название группы</li>\n<li><em>sort_order</em> - порядковый номер</li>\n<li><em>frontend_model</em> - блок, отвечающий за вывод группы (необязательный)</li>\n<li><em>expanded</em> - указывает открыта ли группа по умолчанию</li>\n<li><em>comment</em> - комментарий к группе</li>\n<li><em>fields</em> - структура полей</li>\n<li><em>show_in_default</em> - показывать в дефолтном скоупе</li>\n<li><em>show_in_website</em> - показывать в скоупе вебсайта</li>\n<li><em>show_in_store</em> - показывать в скоупе стора</li>\n</ul>\n<p>Если посмотреть в секцию <strong>design</strong>, то увидим, что ее группы имеют тег <em>fields</em>, в котором задаются параметры для полей. Например, группа <em>package</em></p>\n<pre><code class=\"hljs language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">package</span> <span class=\"hljs-attr\">translate</span>=<span class=\"hljs-string\">\"label\"</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">label</span>&gt;</span>Package<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">label</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sort_order</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sort_order</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_default</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_default</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_website</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_website</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_store</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_store</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">fields</span>&gt;</span>.........<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">fields</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">package</span>&gt;</span>\n</code></pre>\n<p>Для задания поля нужно указать следующие теги</p>\n<ul>\n<li><em>label</em> - название поля</li>\n<li><em>sort_order</em> - порядковый номер</li>\n<li><em>frontend_model</em> - блок, отвечающий за вывод поля (необязательный)</li>\n<li><em>frontend_type</em> - тип поля (необязательный, по умолчанию <em>text</em>)</li>\n<li><em>backend_model</em> - модель отвечающая за валидацию поля на сервере, должна быть объектом класса <em>Mage_Core_Model_Config_Data</em>. Ей передаются определенные данные: <em>path</em>, <em>value</em>, <em>website_code</em>, <em>store_code.</em> Должна реализовать метод <em>_beforeSave</em> (вызывается перед сохранением поля). Также можно реализовать методы <em>afterLoad</em> или <em>getValue</em>, которые вызываются перед тем как отобразить поле. Это нужно, если например в базе поле сохранено как сериализированный массив, т.е. строка, а для его отображения нужно, чтобы оно было массивом (необязательный)</li>\n<li><em>comment</em> - комментарий под полем (необязательный)</li>\n<li><em>sort_fields</em> - указывает как сортировать поля (необязательный, по умолчанию сортирует по <em>sort_order</em>)\n<ul>\n<li><em>by</em> - имя тега по-которому нужно отсортировать</li>\n<li><em>direction_desc</em> - указывает сортировать обратном порядке (по умолчанию сортировка А-Я)</li>\n</ul>\n</li>\n<li><em>config_path</em> - указывает специфический путь для параметра, например <em>package/name</em> (необязательный, если не указан, то путь будет <em>%SECION_NAME%</em> / <em>%GROUP_NAME%</em> / <em>%FIELD_NAME%</em>, где <em>*_NAME</em> - имена тегов)</li>\n<li><em>validate</em> - задает класс полю, благодаря, которому можно будет валидировать поле на клиенте с помощью <em>JavaScript</em> и <em>varienForm</em> класса</li>\n<li><em>source_model</em> - задает модель-источник, используется для типов полей <em>select</em> и <em>multiselect</em>. Если модель является объектом <em>Varien_Object</em>, то ей устанавливается путь к полю (доступ можно получить при помощи метода <em>getPath()</em>). Например, группа <em>debug</em> из секции <em>dev</em> имеет поле <em>profiler</em>, в котором задана сорс модель <strong>adminhtml/system_config_source_yesno</strong>. По умолчанию модель должна реализовать метод <em>toOptionArray</em>, который возвращает массив с опциями. Если Вы хотите использовать специфический метод, то в конце имени ставите 2 раза двоеточие и потом имя метода, например <em>adminhtml/system_config_source_yesno::myMethoName</em>.</li>\n<li><em>depends -</em> указывает поля зависимые от значения данного поля. Пример можно посмотреть в секции каталог, группа <em>Layered Navigation</em> поле <em>Price Navigation Step Calculation</em></li>\n<li><em>tooltip</em> - всплывающая подсказка может быть как просто текстом, так и <em>Magento</em> путем к блоку</li>\n<li><em>show_in_default</em> - показывать в дефолтном скоупе</li>\n<li><em>show_in_website</em> - показывать в скоупе вебсайта</li>\n<li><em>show_in_store</em> - показывать в скоупе стора</li>\n</ul>\n<p>В большинстве случает <em>source</em>, <em>backend</em> и <em>frontend</em> модели писать не прийдется. Нужно просто пройтись по всем настройкам, посмотреть есть ли то что нужно, потом открыть конфигурационный файл и скопировать уже готовые директивы.</p>\n<p>Тег <em>frontend_type</em> может содержать любое значение из полей формы, которые определены в <em>lib/Varien/Data/Form/Element/</em> директории.</p>\n<h2 id=\"sozdanie-svoih-nastroek\"><a name=\"sozdanie-svoih-nastroek\" class=\"h-link\" href=\"#\"></a>Создание своих настроек</h2>\n<p>Чтобы создать свои настройки для начала нужно <app-link to=\"backend\" params=\"{&quot;id&quot;:&quot;magento-sozdanie-crud-modulya&quot;}\">написать модуль</app-link>. В модуле в директории <em>etc</em> создаем файл <em>system.xml</em>. Создадим свой таб и секцию, а также добавим новое поле в секцию Каталог, группу <em>Layered Navigation</em>.</p>\n<p>Так как <em>Magento</em> объединяет все конфиг файлы в один большой <em>XML</em>, то чтобы добавить новый таб нужно всего лишь написать</p>\n<pre><code class=\"hljs language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">config</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">tabs</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">my_tab</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">label</span>&gt;</span>Freaks Tab<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">label</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sort_order</span>&gt;</span>100000<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sort_order</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">my_tab</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">tabs</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sections</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">my_section</span> <span class=\"hljs-attr\">translate</span>=<span class=\"hljs-string\">\"label\"</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">label</span>&gt;</span>My Section<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">label</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">tab</span>&gt;</span>my_tab<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">tab</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">frontend_type</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">frontend_type</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sort_order</span>&gt;</span>910<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sort_order</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_default</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_default</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_website</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_website</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_store</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_store</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groups</span>&gt;</span>\n                <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test_group</span> <span class=\"hljs-attr\">translate</span>=<span class=\"hljs-string\">\"label\"</span>&gt;</span>\n                    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">label</span>&gt;</span>Test Group<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">label</span>&gt;</span>\n                    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sort_order</span>&gt;</span>4<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sort_order</span>&gt;</span>\n                    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_default</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_default</span>&gt;</span>\n                    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_website</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_website</span>&gt;</span>\n                    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_store</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_store</span>&gt;</span>\n                    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">fields</span>&gt;</span>\n                        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">email</span> <span class=\"hljs-attr\">translate</span>=<span class=\"hljs-string\">\"label\"</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">label</span>&gt;</span>Sender Email<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">label</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">frontend_type</span>&gt;</span>text<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">frontend_type</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">backend_model</span>&gt;</span>adminhtml/system_config_backend_email_address<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">backend_model</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">validate</span>&gt;</span>validate-email<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">validate</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sort_order</span>&gt;</span>2<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sort_order</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_default</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_default</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_website</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_website</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_store</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_store</span>&gt;</span>\n                        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">email</span>&gt;</span>\n                        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">name</span> <span class=\"hljs-attr\">translate</span>=<span class=\"hljs-string\">\"label\"</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">label</span>&gt;</span>Sender Name<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">label</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">frontend_type</span>&gt;</span>text<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">frontend_type</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">backend_model</span>&gt;</span>adminhtml/system_config_backend_email_sender<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">backend_model</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">validate</span>&gt;</span>validate-emailSender<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">validate</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sort_order</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sort_order</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_default</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_default</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_website</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_website</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_store</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_store</span>&gt;</span>\n                        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">name</span>&gt;</span>\n                    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">fields</span>&gt;</span>\n                <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test_group</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groups</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">my_section</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sections</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">config</span>&gt;</span>\n</code></pre>\n<p>Теперь, чтобы это заработало нужно очистить кэш, а также создать права доступа для этих параметров (<em>ACL</em>) иначе будете попадать на 404 страницу. В нашем случае добавим <em>ACL</em> только для одной секции <em>my_section</em>. Добавляем информацию об этом в конфиг модуля (config.xml)</p>\n<pre><code class=\"hljs language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">adminhtml</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">acl</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">resources</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">admin</span>&gt;</span>\n                <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">children</span>&gt;</span>\n                    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">system</span>&gt;</span>\n                        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">children</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">config</span>&gt;</span>\n                                <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">children</span>&gt;</span>\n                                    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">my_section</span>&gt;</span>\n                                        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">title</span>&gt;</span>My Section<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">title</span>&gt;</span>\n                                    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">my_section</span>&gt;</span>\n                                <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">children</span>&gt;</span>\n                            <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">config</span>&gt;</span>\n                        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">children</span>&gt;</span>\n                    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">system</span>&gt;</span>\n                <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">children</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">admin</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">resources</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">acl</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">adminhtml</span>&gt;</span>\n</code></pre>\n<p>Более детально об <em>ACL</em> можно прочитать <app-link to=\"backend\" params=\"{&quot;id&quot;:&quot;magento-konfighuratsiia-ot-a-do-ia-bazovye-nastroiki-modulia&quot;}\">здесь</app-link>.</p>\n<p>Выходим из админки, чтобы сессия очистилась, заходим обратно и вот что видим</p>\n<p><img src=\"/media/assets/own_configuration.png\" alt=\"Magento own configuration\" title=\"Magento own configuration\" width=\"600\" height=\"290\"></p>\n<p>Все настройки сохраняются в базу в таблицу <em>core_config_data</em>. Чтобы получить доступ к настройкам используется конструкция</p>\n<pre><code class=\"hljs language-php\">$config = Mage::getStoreConfig(<span class=\"hljs-string\">'path/to/config'</span>[, $storeId]);\n\n<span class=\"hljs-comment\">// in our situation</span>\n$email = Mage::getStoreConfig(<span class=\"hljs-string\">'my_section/test_group/email'</span>);\n$name  = Mage::getStoreConfig(<span class=\"hljs-string\">'my_section/test_group/name'</span>);\n</code></pre>\n<p>Теперь добавим новое поле в уже существующую группу. На самом деле все делается по аналогии и довольно таки просто. Сначала откроем файл <em>system.xml</em> модуля <em>Mage_Catalog</em>. Найдем там группу которая отвечает за <em>Layered Navigation</em>, чтобы скопировать ее код. И потом добавляем новую <em>XML</em> структуру в тег <em>sections</em></p>\n<pre><code class=\"hljs language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">catalog</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groups</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">layered_navigation</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">fields</span>&gt;</span>\n                <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">test_field</span>&gt;</span>\n                    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">label</span>&gt;</span>Test Field<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">label</span>&gt;</span>\n                    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">frontend_type</span>&gt;</span>text<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">frontend_type</span>&gt;</span>\n                    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sort_order</span>&gt;</span>100<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sort_order</span>&gt;</span>\n                    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_default</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_default</span>&gt;</span>\n                    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_website</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_website</span>&gt;</span>\n                    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">show_in_store</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">show_in_store</span>&gt;</span>\n                <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">test_field</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">fields</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">layered_navigation</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groups</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">catalog</span>&gt;</span>\n</code></pre>\n<p>Чистим кэш и заходим через админку в секцию Каталог, группу <em>Layered Navigation</em></p>\n<p><img src=\"/media/assets/custom_config_field.png\" alt=\"Magento custom config field\" title=\"Magento custom config field\" width=\"600\" height=\"199\"></p>\n<p><strong>P.S.</strong>: по ходу изучения моделей в следующих статьях мы вернемся к конфигурации и таким понятиям, как реврайты моделей и как обходится без них при помощи событий.</p>","headings":[["struktura-fajla","Структура файла"],["sozdanie-svoih-nastroek","Создание своих настроек"]],"id":"magento-konfiguratsiya-ot-a-do-ya-systemxml"}