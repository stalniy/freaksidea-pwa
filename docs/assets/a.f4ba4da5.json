{"title":"sjFilemanager  - бесплатный AJAX файл менеджер","summary":"Это open source file manager, написан на PHP с использованием технологии Ajax.\nПочему он лучше? Потому что это не расширение ни для какого из существующих\nпрограммных продуктов! Это полноценное приложение, которое можно использовать\nкак в известном rich text редакторе TinyMCE, так и просто в форме вместо\nстандартного и неудобного тега input[type=\"file\"]\n","author":"sstotskyi","categories":["frontend","important"],"createdAt":"2011-01-21T01:55:00.000Z","meta":{"keywords":["файловый менеджер","ajax"]},"alias":"sjfilemanager----besplatnyj-ajax-fajl-menedzher","content":"<p><img src=\"/media/assets/708eccb6aa0dd09856174f11cde538dc.jpg\" alt=\"sjFilemanager\" loading=\"lazy\" width=\"711\" style=\"max-height: 433px;\" srcset=\"/media/assets/708eccb6aa0dd09856174f11cde538dc-xs.jpg 375w,/media/assets/708eccb6aa0dd09856174f11cde538dc.jpg 1280w\" sizes=\"(max-width: 375px) 375px,1280px\"></p>\n<p>sjFilemanager сначала был разработан в личных целях, для создания чего-то &quot;отличного&quot;, что можно будет переносить из проекта в проект. Но потом я решил поделиться им со всеми.</p>\n<p>Так вот, где можно его использовать - как в известном rich text редакторе TinyMCE, так и в обычной html форме вместо стандартного тега input с атрибутом type = file. Все фичи реализованы посредством AJAX!</p>\n<h2 id=\"vozmozhnosti\"><a name=\"vozmozhnosti\" class=\"h-link\" href=\"#\"></a>Возможности</h2>\n<ul>\n<li>copy/cut/paste файлов</li>\n<li>удаление файлов/папок</li>\n<li>создание динамеческих (уникальных) имен для файлов</li>\n<li>переименование файлов/папок</li>\n<li>изменение прав доступа для файлы/папки</li>\n<li>создание папки</li>\n<li>загрузка нескольких файлов с использованием SWFUpload</li>\n<li>скачивание файлов/папок с использованием zip-компрессора</li>\n<li>вся доступная информация о папке/файле из файловой системы</li>\n<li>дружественный интерфейс</li>\n<li>операции над множеством файлов/папок</li>\n<li>frontend может работать с backend-ом написаным на любом языке</li>\n<li>написаны тесты для backend-а</li>\n</ul>\n<h2 id=\"testirovalos\"><a name=\"testirovalos\" class=\"h-link\" href=\"#\"></a>Тестировалось</h2>\n<ul>\n<li>IE6+</li>\n<li>FireFox 3.0+</li>\n<li>Chrome 8.05</li>\n<li>Opera (9.24, 9.63, 10.52, 10.63)</li>\n</ul>\n<h2 id=\"demo\"><a name=\"demo\" class=\"h-link\" href=\"#\"></a>Демо</h2>\n<p>Скачать можно <a href=\"/media/assets/sjFilemanager.zip\" download=\"sjFilemanager.zip\">ЗДЕСЬ</a>.</p>\n<h2 id=\"tehnicheskie-detali\"><a name=\"tehnicheskie-detali\" class=\"h-link\" href=\"#\"></a>Технические детали</h2>\n<p>Написан с использованием простой javascript библиотеки, имеет в арсенале inline window manager. Backend обслуживает PHP с помощью нескольких классов.</p>\n<p>Итак пришла пора немного рассказать об использовании :)</p>\n<p>Чтобы все заработало, нужно подключить несколько файлов (или минимизировать и положить в один файл) и создать объект FileManage:</p>\n<pre><code class=\"hljs language-html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">html</span> <span class=\"hljs-attr\">xmlns</span>=<span class=\"hljs-string\">\"http://www.w3.org/1999/xhtml\"</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">head</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">meta</span> <span class=\"hljs-attr\">http-equiv</span>=<span class=\"hljs-string\">\"Content-Type\"</span> <span class=\"hljs-attr\">content</span>=<span class=\"hljs-string\">\"text/html; charset=utf-8\"</span> /&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">title</span>&gt;</span>sjFilemanager<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">title</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">\"text/javascript\"</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">\"%base_url%/js/lang/lang_ru.js\"</span>&gt;</span> <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">\"text/javascript\"</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">\"%base_url%/js/pack/sjs.js\"</span>&gt;</span> <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">\"text/javascript\"</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">\"%base_url%/js/pack/swfupload.js\"</span>&gt;</span> <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">\"text/javascript\"</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">\"%base_url%/js/pack/sjFilemanager.js\"</span>&gt;</span> <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">link</span> <span class=\"hljs-attr\">href</span>=<span class=\"hljs-string\">\"%base_url%/css/desktop.css\"</span> <span class=\"hljs-attr\">rel</span>=<span class=\"hljs-string\">\"stylesheet\"</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">\"text/css\"</span> /&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">\"text/javascript\"</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">\"/tools/tiny_mce/tiny_mce.js\"</span>&gt;</span> <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">\"text/javascript\"</span>&gt;</span><span class=\"actionscript\">\n        sjs.ready(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span><span class=\"hljs-params\">()</span></span>{\n            <span class=\"hljs-keyword\">var</span> w = FileManage.getInstance(<span class=\"hljs-literal\">null</span>, <span class=\"hljs-string\">\"%base_url%/?tmpl=window&amp;show_actions=1\"</span>, {\n                dirUrl: <span class=\"hljs-string\">'%base_url%/'</span>,\n                actionUrl: <span class=\"hljs-string\">'%base_url%/'</span>,\n                actionSel: <span class=\"hljs-string\">'#sjFmActions'</span>,\n                events: {\n                    onServerError: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span><span class=\"hljs-params\">(js, html)</span> </span>{\n                        FileManage.createWindow({\n                            id: <span class=\"hljs-keyword\">this</span>.id,\n                            title: $_LANG.TITLE_WARNING,\n                            content: <span class=\"hljs-string\">'&lt;p&gt;'</span> + js.response.msg + <span class=\"hljs-string\">'&lt;/p&gt;'</span>\n                        });\n                    }\n                },\n                upload: {\n                    object:  SWFUpload,\n                    onReadyEventName: <span class=\"hljs-string\">'file_dialog_complete_handler'</span>,\n                    flash_url : <span class=\"hljs-string\">\"%base_url%/js/swfupload/swfupload.swf\"</span>,\n                    file_post_name:<span class=\"hljs-string\">'files'</span>,\n                    custom_settings : {\n                        progressTarget : <span class=\"hljs-string\">\"sjFmUploadProgress\"</span>\n                    },\n                    file_size_limit : <span class=\"hljs-string\">\"10MB\"</span>,\n                    file_types : <span class=\"hljs-string\">\"*.*\"</span>,\n                    file_types_description : <span class=\"hljs-string\">\"All Files\"</span>,\n                    file_upload_limit : <span class=\"hljs-number\">100</span>,\n                    file_queue_limit : <span class=\"hljs-number\">100</span>,\n\n                    button_text_left_padding: <span class=\"hljs-number\">5</span>,\n                    button_text_top_padding: <span class=\"hljs-number\">1</span>,\n                    button_image_url: <span class=\"hljs-string\">\"%base_url%/js/swfupload/sbtn.png\"</span>,\n                    button_placeholder_id: <span class=\"hljs-string\">\"sjFmButtonPlaceHolder\"</span>,\n                    button_text: <span class=\"hljs-string\">'&lt;span class=\"submit\"&gt;Файлы...&lt;/span&gt;'</span>,\n                    button_width: <span class=\"hljs-string\">\"65\"</span>,\n                    button_text_style: <span class=\"hljs-string\">\".submit { font-size: 11; color:#000000; font-family:Tahoma, Arial, serif; }\"</span>,\n                    button_height: <span class=\"hljs-string\">\"20\"</span>,\n                    file_queued_handler: fileQueued,\n                    file_queue_error_handler: fileQueueError,\n                    upload_start_handler: uploadStart,\n                    upload_progress_handler: uploadProgress,\n                    upload_error_handler: uploadError,\n                    upload_success_handler: uploadSuccess\n                }\n            });\n        });\n    </span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">head</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">body</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">\"text\"</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"test_field\"</span> /&gt;</span><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">a</span> <span class=\"hljs-attr\">href</span>=<span class=\"hljs-string\">\"#\"</span> <span class=\"hljs-attr\">onclick</span>=<span class=\"hljs-string\">\"FileManage.choiseCallback(this.previousSibling,'%url_to_upload_dir%', null, window); return false\"</span>&gt;</span>open manager<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">a</span>&gt;</span><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">br</span>/&gt;</span>\n<span class=\"hljs-comment\">&lt;!-- Window tmemplate --&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"sjWindowTmpl\"</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"hide ie6_width_fix\"</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"sjs_wtop\"</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"sjs_wltitle\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"sjs_wrtitle\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"sjs_wtitle\"</span>&gt;</span>Window title<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">img</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">\"%base_url%img/load.gif\"</span> <span class=\"hljs-attr\">alt</span>=<span class=\"hljs-string\">\"\"</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"upload_img\"</span> /&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"sjs_waction\"</span>&gt;</span>\n                <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">a</span> <span class=\"hljs-attr\">href</span>=<span class=\"hljs-string\">\"#\"</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"minimize\"</span> <span class=\"hljs-attr\">onclick</span>=<span class=\"hljs-string\">\"return false;\"</span> <span class=\"hljs-attr\">tabindex</span>=<span class=\"hljs-string\">\"0\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">a</span>\n                &gt;</span><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">a</span> <span class=\"hljs-attr\">href</span>=<span class=\"hljs-string\">\"#\"</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"maximize\"</span> <span class=\"hljs-attr\">onclick</span>=<span class=\"hljs-string\">\"return false;\"</span> <span class=\"hljs-attr\">tabindex</span>=<span class=\"hljs-string\">\"0\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">a</span>\n                &gt;</span><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">a</span> <span class=\"hljs-attr\">href</span>=<span class=\"hljs-string\">\"#\"</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"close\"</span> <span class=\"hljs-attr\">onclick</span>=<span class=\"hljs-string\">\"return false;\"</span> <span class=\"hljs-attr\">tabindex</span>=<span class=\"hljs-string\">\"0\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">a</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"window_main\"</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"bbottom\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"bleft\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"bright\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"sjs_wcontent\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n<span class=\"hljs-comment\">&lt;!-- Window tmemplate --&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">body</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">html</span>&gt;</span>\n</code></pre>\n<p>Шаблон для попапа можно менять, но при условии сохранения классов на DOM элементах. Параметр &quot;upload&quot; предусмотрен для того, чтобы можно было в качестве uploader-а использовать любой объект-класс в будущем или если кого-то не устраивает SWFUpload.</p>\n<p>Метод FileManage.getInstance() создает единственный объект на странице в попап окне. Как же использовать один объект для многих задач? Очень просто. Все, что требуется - это вызывать тот же метод FileManage.getInstance() первым параметром которого есть callback функция.</p>\n<p>FileManage.choiseCallback - это простая обертка для FileManage.getInstance(), которая очень удобна, например, для того чтобы можно было вставить только один файл в input[type=&quot;text&quot;]. Прототипы методов:</p>\n<pre><code class=\"hljs language-php\">FileManage.getInstance = <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span><span class=\"hljs-params\">(function callback, string url, hash fmCfg, hash windowCfg)</span></span>;\n\nFileManage.choiseCallback = <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span><span class=\"hljs-params\">(DOMObject field, string url, string type, object window)</span></span>;\n</code></pre>\n<p>Раз так, тогда использовать sjFilemanager в TinyMCE очень просто!</p>\n<pre><code class=\"hljs language-javascript\">tinyMCE.init({\n    <span class=\"hljs-comment\">// General options</span>\n    <span class=\"hljs-attr\">mode</span> : <span class=\"hljs-string\">\"textareas\"</span>,\n    <span class=\"hljs-attr\">theme</span> : <span class=\"hljs-string\">\"advanced\"</span>,\n    <span class=\"hljs-attr\">plugins</span> : <span class=\"hljs-string\">\"media,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras\"</span>,\n    <span class=\"hljs-attr\">editor_selector</span> : <span class=\"hljs-string\">\"mceEditor\"</span>,\n    <span class=\"hljs-attr\">language</span> : <span class=\"hljs-string\">\"en\"</span>,\n    <span class=\"hljs-attr\">convert_urls</span>: <span class=\"hljs-literal\">false</span>,\n    <span class=\"hljs-attr\">theme</span> : <span class=\"hljs-string\">\"advanced\"</span>,\n    <span class=\"hljs-attr\">debug</span> : <span class=\"hljs-literal\">false</span>,\n    <span class=\"hljs-attr\">paste_auto_cleanup_on_paste</span> : <span class=\"hljs-literal\">true</span>,\n    <span class=\"hljs-attr\">paste_convert_headers_to_strong</span> : <span class=\"hljs-literal\">true</span>,\n    <span class=\"hljs-comment\">// Theme options</span>\n    <span class=\"hljs-attr\">theme_advanced_buttons1</span> :<span class=\"hljs-string\">\"undo,redo,|,bold,italic,underline,strikethrough,forecolor,backcolor,|,sub,sup,charmap,|,hr,removeformat\"</span>,\n    <span class=\"hljs-attr\">theme_advanced_buttons2</span> : <span class=\"hljs-string\">\"pastetext,pasteword,|,search,|,bullist,numlist,|,outdent,indent,|,link,unlink,image,media,cleanup,code,fullscreen\"</span>,\n    <span class=\"hljs-attr\">theme_advanced_buttons3</span> : <span class=\"hljs-string\">\"tablecontrols\"</span>,\n     <span class=\"hljs-attr\">theme_advanced_toolbar_location</span> : <span class=\"hljs-string\">\"top\"</span>,\n    <span class=\"hljs-attr\">theme_advanced_toolbar_align</span> : <span class=\"hljs-string\">\"left\"</span>,\n    <span class=\"hljs-attr\">theme_advanced_statusbar_location</span> : <span class=\"hljs-literal\">false</span>,\n    <span class=\"hljs-attr\">file_browser_callback</span>: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">field, url, type, win</span>)</span>{\n        <span class=\"hljs-comment\">// %root_url% - path to work directory of filemanager. $sjConfig['root_url']</span>\n        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-built_in\">window</span>.FileManage) {\n            FileManage.choiseCallback(field, <span class=\"hljs-string\">\"%root_url%\"</span>, type, win);\n        }\n    }\n});\n</code></pre>\n<p>Открыв обычный advimage plugin увидим следующее (аналогичная ситуация со всеми плагинами в которых используется tinyMCE file_browser_callback опция):<a href=\"/media/assets/3b8971deecefbc7defeedecc3a041994.jpeg\" title=\"advimage\" download=\"3b8971deecefbc7defeedecc3a041994.jpeg\"><img src=\"/media/assets/3b8971deecefbc7defeedecc3a041994_500_0_0.jpg\" alt=\"advimage\" loading=\"lazy\" width=\"500\" style=\"max-height: 318px;\" srcset=\"/media/assets/3b8971deecefbc7defeedecc3a041994_500_0_0-xs.jpg 375w,/media/assets/3b8971deecefbc7defeedecc3a041994_500_0_0.jpg 1280w\" sizes=\"(max-width: 375px) 375px,1280px\"></a>Ну и последнее - пишем свой callback для выбора нескольких файлов и отображения их пользователю:</p>\n<ul>\n<li>\n<p>JavaScript:</p>\n<pre><code class=\"hljs language-php\">sjs(<span class=\"hljs-string\">'#container'</span>).onEvent(<span class=\"hljs-string\">'click'</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span><span class=\"hljs-params\">(e)</span></span>{\n    <span class=\"hljs-keyword\">var</span> <span class=\"hljs-keyword\">$this</span> = sjs.event.caller(e);\n    <span class=\"hljs-keyword\">if</span> (!sjs.nodeName(<span class=\"hljs-keyword\">$this</span>, <span class=\"hljs-string\">'a'</span>)) {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">true</span>;\n    }\n\n    <span class=\"hljs-keyword\">$this</span>.parentNode.parentNode.removeChild(<span class=\"hljs-keyword\">$this</span>.parentNode);\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">false</span>;\n});\nsjs(<span class=\"hljs-string\">'#customCallback'</span>).onEvent(<span class=\"hljs-string\">'click'</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span><span class=\"hljs-params\">(e)</span></span>{\n    FileManage.getInstance(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span><span class=\"hljs-params\">()</span></span>{\n        <span class=\"hljs-keyword\">var</span> data = this.getChecked(), i = data.length,\n            wr = <span class=\"hljs-number\">0</span>, url = <span class=\"hljs-string\">\"%url_to_upload_dir%\"</span> + this.getCurrentPath(),\n            ins = sjs(<span class=\"hljs-string\">'#container'</span>);\n\n        <span class=\"hljs-keyword\">if</span> (!i) {\n            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">false</span>;\n        }\n\n        <span class=\"hljs-keyword\">while</span> (i--) {\n            <span class=\"hljs-keyword\">var</span> label = sjs(data[i].cells[<span class=\"hljs-number\">1</span>]).first()[<span class=\"hljs-number\">0</span>], html = <span class=\"hljs-string\">''</span>,\n                file  = url + sjs(data[i]).find(<span class=\"hljs-string\">'input[type=\"checkbox\"]:checked'</span>)[<span class=\"hljs-number\">0</span>].value.trim();\n            wr = sjs(<span class=\"hljs-string\">'&lt;div class=\"wrapps\"&gt;&lt;/div&gt;'</span>)\n\n            <span class=\"hljs-keyword\">if</span> (/s+(?:jpe?g|gif|png)s+/i.test(<span class=\"hljs-string\">' '</span>+label.className+<span class=\"hljs-string\">' '</span>)) {\n                html = <span class=\"hljs-string\">'&lt;img src=\"'</span> + file + <span class=\"hljs-string\">'\" alt=\"'</span>+file+<span class=\"hljs-string\">'\" style=\"max-width:100px\" /&gt;'</span>;\n            } <span class=\"hljs-keyword\">else</span> {\n                html = <span class=\"hljs-string\">'&lt;span&gt;'</span>+file+<span class=\"hljs-string\">'&lt;/span&gt;'</span>;\n            }\n            html += <span class=\"hljs-string\">'&lt;br /&gt;&lt;a href=\"#\"&gt;delete&lt;/a&gt;&lt;input type=\"hidden\" name=\"files[]\" value=\"'</span>+file+<span class=\"hljs-string\">'\" /&gt;'</span>;\n            ins.append(wr.html(html));\n        }\n        FileManage.windowInstance.close();\n    });\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">false</span>;\n})\n</code></pre>\n</li>\n<li>\n<p>HTML:</p>\n<pre><code class=\"hljs language-html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">html</span>&gt;</span>\n..........\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">\"hidden\"</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"test_field2\"</span> /&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">a</span> <span class=\"hljs-attr\">href</span>=<span class=\"hljs-string\">\"#\"</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"customCallback\"</span>&gt;</span>open manager<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">a</span>&gt;</span>\n.........\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">html</span>&gt;</span>\n</code></pre>\n</li>\n</ul>\n<p>Возникли вопросы? Пишите в комментариях - постараюсь всем помочь :)</p>\n<h2 id=\"planiruetsya\"><a name=\"planiruetsya\" class=\"h-link\" href=\"#\"></a>Планируется</h2>\n<ul>\n<li>исправление дизайн-бага в ІЕ8 при загрузке файлов</li>\n<li>создать простой редактор рисунков</li>\n<li>полная локализация на русский язык</li>\n<li>preview для медиа файлов</li>\n<li>создание простой авторизации</li>\n</ul>\n<p>А завтра я покажу, как просто создать плагин sjFilemanager для Symfony 1.4</p>","headings":[["vozmozhnosti","Возможности"],["testirovalos","Тестировалось"],["demo","Демо"],["tehnicheskie-detali","Технические детали"],["planiruetsya","Планируется"]],"id":"sjfilemanager-besplatnyi-ajax-fail-menedzher"}