{"title":"3G МТС Коннект. Наcтройка ZTE AC5710 модема под Linux","summary":"В общем по некоторым причинам мне пришлось перейти на 3G интернет. И так как я\nиспользую в качестве ОС - Ubuntu, то мне пришлось немного потрудится чтобы все\nэто заработало. Итак купил я МТС Коннект...\n","author":"sstotskyi","categories":["devops"],"createdAt":"2011-01-27T06:55:00.000Z","meta":{"keywords":["3G","модем","linux"]},"alias":"3g-mts-konnekt-nactrojka-zte-ac5710-modema-pod-linux","content":"<p>Итак, став счастливым обладателем такой вещицы, как ZTE AC5710,</p>\n<p><img src=\"/media/assets/fd6c34df85aeef542dc1e0c043f69352.jpeg\" alt=\"images\" loading=\"lazy\" width=\"229\" style=\"max-height: 102px;\"></p>\n<p>я не знал куда деть свое счастье на протяжение нескольких дней :).</p>\n<p>Для начала я решил попробовать установить все на Windows, чтобы убедится что все в рабочем состоянии. После установки я тут же полез в папку <strong>Program Files/%MTS Connect%/drivers/linux</strong> и к своему удивлению, там таки можно обнаружить драйвер :). К сожалению у меня не получилось его скомпилировать под Ubuntu 9.10. Тогда я оставил эту затею и начал искать информацию у всезнающего Google-а.</p>\n<p>После многих поисков и попыток, у меня ничего не получалось. Никак не мог найти настройки именно для ZTE AC5710. Тогда я попытался сделать все по аналогии с другими модемами.</p>\n<p>Узнав о неизвестных мне ранее свойствах <strong>vendor</strong> и <strong>product</strong> для устройств на Linux у меня сначала была паника. Но это все ничего. Начнем же настраивать наш модем :)</p>\n<p>Первое что нужно сделать, это запустить команду <strong>lsusb</strong>, посмотрим определилось ли вообще устройство</p>\n<pre><code class=\"hljs language-bash\">enej@linux:~$ lsusb\nBus 006 Device 097: ID 19d2:fff5 ONDA Communication S.p.A.\nBus 006 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub\nBus 003 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub\nBus 005 Device 002: ID 0458:003a KYE Systems Corp. (Mouse Systems)\nBus 005 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub\nBus 001 Device 002: ID 04f2:b024 Chicony Electronics Co., Ltd USB 2.0 Webcam\nBus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub\nBus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub\nBus 007 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub\nBus 004 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub\n</code></pre>\n<p>Ищем где же здесь нужное нам устройство, методом исключений :) или же если вы знаете &quot;магические&quot; <strong>vendor</strong> и <strong>product</strong>, которые здесь записаны через &quot;:&quot;.</p>\n<p>Для ZTE AC5710 <strong>vendor=19d2</strong>, а <strong>product=fff5</strong> . Значит у меня как минимум модем определен. Так как модем работает в режиме <a href=\"http://wiki.vectormm.net/index.php/ZeroCD\" title=\"zerocd zte ac5710\" target=\"_blank\" rel=\"noopener nofollow\">ZeroCD</a>, на нем есть драйвера для нескольких популярных операционных систем.</p>\n<p>ZeroCD - это технология, суть которой заключается в том, что в момент подключения к компьютеру новое USB-устройство подключает виртуальный CD-ROM, на котором находятся необходимые драйверы. Для того, чтобы устройство стало готово к выполнению тех задач, для которых было разработано, необходимо отключить ZeroCD. Драйвер устройства сделает это автоматически, однако при отсутствии такового (например для любимого Linux) необходимо отключить самостоятельно.</p>\n<p>Для того чтобы отключить самостоятельно нам нужно установить некоторые Debian пакеты, скачать которые вы можете <a href=\"/media/assets/modem.utils.tar.bz2\" download=\"modem.utils.tar.bz2\">ЗДЕСЬ</a>. Кому не нужен UI интерфейс для подключения к интернет, может не устанавливать gnome-ppp пакет.</p>\n<p>Отлично раз все установлено, открываем файл <strong>/etc/usb_modeswitch.conf</strong>. И пробуем найти там <strong>vendor</strong> и <strong>product</strong> для своего модема. Для ZTE AC5710, я не нашел, поэтому пишем в конец файла следующее и ничего не откоментируем!</p>\n<p>**`**DefaultVendor=  0x19d2\nDefaultProduct= 0xfff5</p>\n<p>TargetVendor=   0x19d2\nTargetProduct=  0xffff**`**</p>\n<p>Пытаемся подключить модем с помощью <strong>usbserial</strong> и <strong>option</strong> драйверов. Для начала нужно отключить <strong>usbserial</strong> и подключить его с нужными <strong>vendor</strong> и <strong>product</strong>. Для этого нам понадобятся права супер пользователя (<strong>root</strong>)</p>\n<pre><code class=\"hljs language-bash\">root@linux:/home/enej<span class=\"hljs-comment\"># rmmod option;</span>\nroot@linux:/home/enej<span class=\"hljs-comment\"># rmmod usbserial;</span>\nroot@linux:/home/enej<span class=\"hljs-comment\"># usb_modeswitch;</span>\nroot@linux:/home/enej<span class=\"hljs-comment\"># sleep 2;</span>\nroot@linux:/home/enej<span class=\"hljs-comment\"># modprobe usbserial vendor=0x19d2 product=0xffff;</span>\nroot@linux:/home/enej<span class=\"hljs-comment\"># modprobe option;</span>\n</code></pre>\n<p>Для проверки переключилось ли устройство в режим модема</p>\n<pre><code class=\"hljs language-php\">root@linux:/home/enej<span class=\"hljs-comment\"># lsusb | grep '19d2:ffff'</span>\nBus <span class=\"hljs-number\">006</span> Device <span class=\"hljs-number\">097</span>: ID  <span class=\"hljs-number\">19</span>d2:ffff ONDA Communication S.p.A.\n</code></pre>\n<p>и</p>\n<pre><code class=\"hljs language-php\">root@linux:/home/enej<span class=\"hljs-comment\"># dmesg | grep 'attached to ttyUSB'</span>\n[<span class=\"hljs-number\">280563.573308</span>] usb <span class=\"hljs-number\">6</span><span class=\"hljs-number\">-2</span>: generic converter now attached to ttyUSB0\n[<span class=\"hljs-number\">280563.573437</span>] usb <span class=\"hljs-number\">6</span><span class=\"hljs-number\">-2</span>: generic converter now attached to ttyUSB1\n[<span class=\"hljs-number\">280563.573562</span>] usb <span class=\"hljs-number\">6</span><span class=\"hljs-number\">-2</span>: generic converter now attached to ttyUSB2\n[<span class=\"hljs-number\">280563.573683</span>] usb <span class=\"hljs-number\">6</span><span class=\"hljs-number\">-2</span>: generic converter now attached to ttyUSB3\n</code></pre>\n<p>Если есть что-то похожее как у меня, то я Вас поздравляю все получилось :)</p>\n<p>Теперь включаем <strong>wvdial</strong> для соединения с интернетом. Настройки для этой утилиты можно скачать <a href=\"/media/assets/wvdial.zip\" download=\"wvdial.zip\">ЗДЕСЬ</a>.</p>\n<pre><code class=\"hljs language-php\">root@linux:/home/enej<span class=\"hljs-comment\"># wvdial -C /root/.wvdial.conf;</span>\n</code></pre>\n<p>Если есть подключение на этом все :)</p>\n<p>Если что-то не получается всегда смотрите <strong>dmesg</strong>, оставляйте комментарии, пишите, с удовольствием отвечу на Ваши вопросы :)</p>\n<p>Для упрощения себе жизни я написал маленький скрипт для подключения модема, который можно скачать <a href=\"/media/assets/enable_modem.sh\" download=\"enable_modem.sh\">ЗДЕСЬ</a>. Запускается он только с правами <strong>root</strong>.</p>","headings":[],"id":"3g-mts-konnekt-nactrojka-zte-ac5710-modema-pod-linux"}